{% extends "layout.html" %}
{% block head %}
<style>
  html {
      height: 100%;
      overflow-x: scroll;
    }

    body {
      width: 10000px;
      min-height: 100%;
      overflow-y: hidden;
      background-color: #3c9bec;
    }
    table, tr, td, th {
        padding: 5px;
        margin: 20px 0;
    }
    .wolke1 {
      height: 100%;
      background: url(/static/img/wolke1.png);
    }

    .wolke2 {
      height: 100%;
      background: url(/static/img/wolke2.png);
      height: 1200px;
    }
    .slot {
        margin:10px 10px 0 10px;
        background-color: white;
    }
    .entry {
        margin:10px 0;
    }
    .source {
      font-size:xx-small;
    }
    .data {
        color:white;
        margin: 2px 10px;
    }
    .data.temp_max {
        background-color:#550000;
    }
    .data.temp_cur {
        background-color:#660000;
    }
    .data.wind_spd {
        background-color:#770000;
    }
    .data.warning {
        background-color:#ff0000;
        text-decoration:blink;
    }
    #plot {
      width: 800px;
      height: 300px;
    }
  </style>
{% endblock %}
{% block content %}
<div class="wolke1">
  <div class="wolke2">
    <table>
    <tr>
        <th>&nbsp;</th>
        {% for slot,entries in grouped_by_timeslot %}
        <th class="slot" id="{{ slot }}">{{ slot }}</th>
        {% endfor %}
    </tr>

    <tr>
        <td>Temp Max</td>
        {% for slot,entries in grouped_by_timeslot %}
        <td class="data temp_max" id="temp_max_{{ slot }}">
            {% for entry in entries.itervalues() %}
                {% if entry.temperature_max %}<span class="source">{{ entry.source }}</span> <span class="value">{{ "%3.1f" % entry.temperature_max }}°C</span><br />{% endif %}
            {% endfor %}
        </td>
        {% endfor %}
    </tr>

    <tr>
        <td>Temp Cur</td>
        {% for slot,entries in grouped_by_timeslot %}
        <td class="data temp_cur" id="temp_cur_{{ slot }}">
            {% for entry in entries.itervalues() %}
                {% if entry.temperature_current %}<span class="source">{{ entry.source }}</span> <span class="value">{{ "%3.1f" % entry.temperature_current }}°C</span><br />{% endif %}
            {% endfor %}
        </td>
        {% endfor %}
    </tr>

    <tr>
        <td>Wind Speed</td>
        {% for slot,entries in grouped_by_timeslot %}
        <td class="data wind_spd" id="wind_spd_{{ slot }}">
            {% for entry in entries.itervalues() %}
                {% if entry.wind_speed %}<span class="source">{{ entry.source }}</span> <span class="value">{{ "%4.1f" % entry.wind_speed }} km/h {{ entry.wind_direction }}</span><br />{% endif %}
            {% endfor %}
        </td>
        {% endfor %}
    </tr>


    <tr>
        <td>Warning</td>
        {% for slot,entries in grouped_by_timeslot %}
        <td class="data warning" id="warning_{{ slot }}">
            {% for entry in entries.itervalues() %}
                {% if entry.warning %}<span class="source">{{ entry.source }}</span> <span class="value">{{ entry.warning }}<br />{% endif %}
            {% endfor %}
        </td>
        {% endfor %}
    </tr>

    </table>

    <div id="plot"></div>
  </div>
</div>
{% endblock %}
{% block js %}


  $.fn.parallax = function(options){
      var $$ = $(this);
      offset = $$.offset();
      var defaults = {
          "start": 0,
          "stop": offset.left + $$.width(),
          "coeff": 0.95
      };
      var opts = $.extend(defaults, options);
      return this.each(function(){
      $(window).bind('scroll', function() {
              windowLeft = $(window).scrollLeft();
              if((windowLeft >= opts.start) && (windowLeft <= opts.stop)) {
                  newCoord = windowLeft * opts.coeff;
                  $$.css({
                      "background-position": newCoord + "px 0"
                  });
              }
          });
      });
  };
  $('.wolke1').parallax({ "coeff":-0.65 });
  $('.wolke2').parallax({ "coeff":1.15 });
  var plot_data = {{ plot_data }};
  $.plot($("#plot"), plot_data, {xaxis: {
    mode: "time",
    timeformat: "%d.%m."
  }});
    
{% endblock %}



